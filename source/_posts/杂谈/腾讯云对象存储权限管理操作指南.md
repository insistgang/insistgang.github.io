---
title: 腾讯云对象存储权限管理操作指南
tags: cos
categories:
  - 教程
  - cos
cover: /img/cos.png
swiper_index: 3
swiper_desc: cos使用教程
swiper_cover: /img/cos.png
abbrlink: e350326d
date: 2022-01-01 17:05:25
---
## 第一步：登录网站
[腾讯云官网](https://cloud.tencent.com/)
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud1.png)

点击左上角的登入选项，进行界面的登录
[登录页面](https://cloud.tencent.com/login)
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud2.png)
可以进行多端登录，这里推荐使用微信直接扫码进行登录
## 第二步：对象存储
登录后进入如下界面，将鼠标移动到左上角产品，点击中间的对象存储，进入对象存储界面
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud3.png)

点击立即使用跳转到对象存储界面。
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud4.png)
## 第三步：创建存储桶
点击左侧的存储桶列表，进行查看存储桶，再点击创建存储桶进行存储桶的创建
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud5.png)

按照存储桶的创建要求进行创建，输入存储名称，修改存储桶所处地域默认是南京，修改成上海，修改访问权限为公有读写，最后点击确定
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud6.png)

点击确定后到达这个界面，可以进行文件的上传，文件夹的创建等操作
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud7.png)
## 第四步：访问管理
将鼠标移至右上角，点击访问管理
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud8.png)

选择最左边一栏的访问密钥,API密钥管理

![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud9.png)
一般的他会提示你使用主账号存在危险情况，建议使用子账号，不用管点击继续使用。
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud10.png)

点击新建密钥来进行创建密钥
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud11.png)

点击显示来显示密钥，这里的密钥常常用于文件的上传，代码如下
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud12.png)
这些代码是Python代码，需要安装一下Python的开发环境和python的IDEA：pycharm来进行运行，根据自己的密钥修改一下secret_id和secret_key，region的内容在下图先点击存储桶列表中中间的所处地域的地址，endpoint的内容需要点击配置管理，其中的域名信息进行复制，下面代码也有注释
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud29.png)
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud30.png)
```python
# -*- coding=utf-8
# appid 已在配置中移除,请在参数 Bucket 中带上 appid。Bucket 由 BucketName-APPID 组成
# 1. 设置用户配置, 包括 secretId，secretKey 以及 Region
from qcloud_cos import CosConfig
from qcloud_cos import CosS3Client
import sys
import logging
logging.basicConfig(level=logging.INFO, stream=sys.stdout)
secret_id = ''      # 替换为用户的 secretId
secret_key = ''      # 替换为用户的 secretKey
region = 'ap-shanghai'     # 替换为用户的 Region
token = None                # 使用临时密钥需要传入 Token，默认为空，可不填
scheme = 'https'            # 指定使用 http/https 协议来访问 COS，默认为 https，可不填
proxies = {
   'http': '127.0.0.1:80', # 替换为用户的 HTTP代理地址
   'https': '127.0.0.1:443' # 替换为用户的 HTTPS代理地址
}
endpoint = 'store-message-1300019806.cos.ap-shanghai.myqcloud.com' # 替换为用户的 endpoint
config = CosConfig(Region=region, SecretId=secret_id, SecretKey=secret_key, Token=token, Scheme=scheme)
# 2. 获取客户端对象
client = CosS3Client(config)
#参照下文的描述。或者参照 Demo 程序，详见 https://github.com/tencentyun/cos-python-sdk-v5/blob/master/qcloud_cos/demo.py
## 文件的上传
with open('cloud3.png', 'rb') as fp:
   response = client.put_object(
       Bucket='store-message-1300019806',
       Body=fp,
       Key='cloud/cloud3.png',
       StorageClass='STANDARD',
       EnableMD5=False
   )
###  获取文件到本地
# response = client.get_object(
#    Bucket='store-message-1300019806',
#    Key='picture.jpg',
# )
# response['Body'].get_stream_to_file('123qwe.jpg')

```
将上面代码中的文件的上传和下载拆解下来，先是文件的上传，代码如下cloud3.png是本地图片的名称，Bucket是存储桶的名称在下图上第一列内容，第三个key是上传到云端的名称，cloud/就是这个文件夹下的cloud3.png这个文件名称。
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud29.png)
```py
with open('cloud3.png', 'rb') as fp:
   response = client.put_object(
       Bucket='store-message-1300019806',
       Body=fp,
       Key='cloud/cloud3.png',
       StorageClass='STANDARD',
       EnableMD5=False
   )
```
文件的下载代码如下,Bucket和上面一样是存储桶的名称，key是云端文件的名称，get_stream_to_file是下载到本地图片的名称
```py
##  获取文件到本地
response = client.get_object(
   Bucket='store-message-1300019806',
   Key='picture.jpg',
)
response['Body'].get_stream_to_file('123qwe.jpg')
```
## 第六步：创建子账号（可创建多个，以创建一个为示例）
在访问管理中，点击左侧的用户，点击用户列表，新建用户
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud13.png)

点击中间的自定义创建
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud14.png)

点击下一步
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud15.png)

输入用户名和访问方式，编程访问和控制台访问都选，这样就可以在子账户上直接通过腾讯云控制台来看到对象存储的内容了。

![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud16.png)

安全起见，登录保护和操作保护都要点一下**启动虚拟MFA设备校验**,这个校验简而言之就是每次进行一些安全性操作的时候都要进行一次扫码身份验证，这样能大大提高操作的安全性，还有上面的密码可以自定义可以默认生成，我这里没有选择他会进行默认生成。
当然为了方便起见，创建子账号直接能用不需要身份认证，直接点击不开启，省了很多认证的麻烦。
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud17.png)

点击下一步，进行权限的选择，主要需要的三个权限和上述的内容相似，不选的话就是没有任何权限，选第一个权限是比较大的。
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud18.png)

最后生成了用户名，密码还有密钥，用户名和密码进行腾讯云登录操作，密钥进行代码的上传和下载
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud19.png)

## 第七步：登录子用户

打开一个新的浏览器，点击子用户登录。
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud20.png)

子用户登录这里有一个id是主账号的id，在主账号的右上角，鼠标移动到头像，点击账号信息
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud21.png)
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud22.png)
可以看到自己的账号信息和id，子账户登录的时候需要的就是主账号的账号id，子账号id寻找的方式和主账号一样，后面会讲到。
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud23.png)


输入主账号id，以及上面的账号和密码，即可登录，登录后需要修改密码，修改密码的规范在访问管理的用户设置中，默认是至少八位含大小写字母，数字，特殊字符，我设置的密码都是123qwe123___Q
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud24.png)
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud25.png)

重置密码后需要完善个人信息，通过手机验证码的方式，进行认证
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud26.png)

登录完成后就进入了腾讯云的主界面
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud27.png)

依旧移动到产品选择对象存储进入到对象存储界面
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud28.png)

## 第八步：访问路径授权管理

返回主账号的对象存储界面，即将鼠标移动到云产品下点击对象存储
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud31.png)

回到对象存储界面点击存储桶列表，点击存储桶名称，进入到存储桶的内容中来
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud32.png)

进入存储桶之后点击左上角的创建文件，对文件进行创建
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud33.png)

创建出两个文件之后，可以对所创建的文件进行设置权限
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud34.png)

进入权限设置界面的时候，可以直接对用户进行权限的添加，点击添加权限
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud35.png)

在弹出的界面框中，第一步选择子账号，第二步输入子账号ID，第三步选择完全控制，第四步点击保存，最后一步进行关闭
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud36.png)

子账号ID所在的位置：首先到子账号界面，将鼠标移动到右上角，点击账号信息，进入到账号界面，就可以看到子账号了。
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud37.png)
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud38.png)

点击刚刚已经授权的文件，进入页面，将文件的目录复制下来
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud39.png)
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud40.png)

选择子账号，到对象存储，点击访问路径，点击添加访问路径
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud41.png)

在添加访问路径界面，修改当前所处的地域，输入刚刚复制的访问路径，首先添加跟路径将后面的/123去除掉，其次添加刚刚复制的路径，最后点击确定。
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud42.png)

最后产生了两个路径入下图所示
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud43.png)

点击第二个就可以刚刚授予权限的文件夹下进行查看内容了
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud44.png)

进入之后可以看到里面存在的文件，可以进行文件的上传和下载的操作
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud45.png)

可以点击存储桶路径进行直接查看
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud46.png)

因为没有授权，所以不可以访问其中的内容
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud47.png)

也可以直接进入存储桶中，直接查看是否存在存储桶，也是一样的无法访问
![](https://store-message-1300019806.cos.ap-shanghai.myqcloud.com/cloud/cloud48.png)


就这样权限的授予操作也就完成了，可以根据不同的存储桶的不同权限给予路径。
